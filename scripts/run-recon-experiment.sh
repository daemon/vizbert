python -m vizbert.run.train_pp_probe -df ${DATA} --layer-idx ${LAYER} --model bert-base-uncased --load-weights ${MODEL_WORKSPACE} -d ${TASK} --lr 5e-4 --probe-rank ${PROBE_RANK} --objective recon --workspace workspaces/recon-probe-${TASK}-r${PROBE_RANK}-l${LAYER} --num-epochs ${NUM_EPOCHS} --no-mask-first --inverse -msl ${MSL}
echo "Project out"
python -m vizbert.run.finetune_classification -df ${DATA} -d ${TASK} -w ${MODEL_WORKSPACE} --num-warmup-steps 100 --num-epochs 30 --lr 5e-4 -msl ${MSL} -bsz 16 --load-weights --eval-only --probe-path workspaces/recon-probe-${TASK}-r${PROBE_RANK}-l${LAYER} --probe-rank ${PROBE_RANK} --layer-idx ${LAYER} --no-mask-first --no-mask-first
echo "Project onto"
python -m vizbert.run.finetune_classification -df ${DATA} -d ${TASK} -w ${MODEL_WORKSPACE} --num-warmup-steps 100 --num-epochs 30 --lr 5e-4 -msl ${MSL} -bsz 16 --load-weights --eval-only --probe-path workspaces/recon-probe-${TASK}-r${PROBE_RANK}-l${LAYER} --probe-rank ${PROBE_RANK} --layer-idx ${LAYER} --no-mask-first --no-mask-first --inverse
# python -m vizbert.run.visualize_probe -df ${DATA} -d ${TASK} --load-weights ${MODEL_WORKSPACE} --model bert-base-uncased -l ${LAYER} --workspace workspaces/recon-probe-${TASK}-r${PROBE_RANK}-l${LAYER} --probe-rank ${PROBE_RANK} --output-folder visuals/pp-probe-${TASK}-r${PROBE_RANK}-l${LAYER} --limit 200 --optimize-mean --inverse
